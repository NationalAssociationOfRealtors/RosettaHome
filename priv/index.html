<html>
    <head>
        <title>Test</title>
    </head>
    <body>
        <button id="on" onclick="on();">ON</button>
        <button id="off" onclick="off()">OFF</button>
        <div id="messages"></div>
    </body>
    <script>
    var node_id = "230046000e47343432313031";
    var user_id = Math.floor(Math.random()*10000000);
    websocket = new WebSocket('ws://localhost:8080/ws?node_id='+node_id+'&user_id='+user_id);
    websocket.onopen = function(evt) {
        console.log(evt);
    };
    websocket.onclose = function(evt) {
        console.log(evt)
    };
    websocket.onmessage = function(evt) {
        console.log(evt);
        var evnt = JSON.parse(evt.data);
        document.getElementById("messages").appendChild(document.createTextNode(evnt.type+": "+evnt.value));
    };

    function on(){
        var message = {type:"light", "data":"on"}
        websocket.send(JSON.stringify(message));
    }

    function off(){
        var message = {type:"light", "data":"off"}
        websocket.send(JSON.stringify(message));
    }

    var state = "on";
    //setInterval(function(){
    //    var message = {id:id, type:"light", "data":state}
    //    websocket.send(JSON.stringify(message));
    //    if(state == "on"){
    //        state = "off";
    //    }else{
    //        state = "on";
    //    }
    //}, 10);
    </script>
</html>
